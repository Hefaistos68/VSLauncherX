<Window x:Class="VSLauncher.Views.ImportFolderWindow"
 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
 xmlns:dm="clr-namespace:VSLauncher.DataModel;assembly=VSLXshared"
 xmlns:conv="clr-namespace:VSLauncher.Converters"
 Title="Import Folder" Height="520" Width="700" WindowStartupLocation="CenterOwner" ResizeMode="NoResize"
 Background="{DynamicResource WindowBackgroundBrush}" Foreground="{DynamicResource WindowForegroundBrush}">
	<Window.Resources>
		<conv:IconToImageSourceConverter x:Key="IconToImageSourceConverter"/>
		<conv:ItemToIconConverter x:Key="ItemToIconConverter"/>
		<conv:ItemToFileTextConverter x:Key="ItemToFileTextConverter"/>
		<Style TargetType="TreeViewItem">
			<Setter Property="HorizontalContentAlignment" Value="Stretch" />
			<Setter Property="Padding" Value="2" />
		</Style>
	</Window.Resources>
	<Grid Margin="10" Background="{DynamicResource PanelBackgroundBrush}">
		<Grid.RowDefinitions>
			<RowDefinition Height="Auto"/>
			<!-- label row -->
			<RowDefinition Height="Auto"/>
			<!-- folder selection row -->
			<RowDefinition Height="Auto"/>
			<!-- options row -->
			<RowDefinition Height="*"/>
			<!-- tree row -->
			<RowDefinition Height="Auto"/>
			<!-- buttons row -->
		</Grid.RowDefinitions>
		<Grid.ColumnDefinitions>
			<ColumnDefinition Width="*"/>
			<ColumnDefinition Width="Auto"/>
			<ColumnDefinition Width="Auto"/>
		</Grid.ColumnDefinitions>
		<!-- Folder name label -->
		<TextBlock Grid.Row="0" Grid.Column="0" Text="Folder name" Margin="0,0,0,4" FontWeight="Bold"/>
		<!-- Folder selection -->
		<TextBox x:Name="txtFolder" Grid.Row="1" Grid.Column="0" Height="28" VerticalContentAlignment="Center" Margin="0,0,8,6" IsEnabled="False" IsReadOnlyCaretVisible="True" IsManipulationEnabled="True"/>
		<Button x:Name="btnSelectFolder" Grid.Row="1" Grid.Column="1" Content="..." Width="34" Height="28" Click="Browse_Click" Margin="0,0,4,6"/>
		<Button x:Name="btnRefresh" Grid.Row="1" Grid.Column="2" Width="34" Height="28" ToolTip="Refresh" Click="Refresh_Click" Margin="0,0,0,6">
			<Image Source="pack://application:,,,/Resources/Images24/Refresh.png" Width="24" Height="24"/>
		</Button>
		<!-- Options -->
		<StackPanel Grid.Row="2" Grid.Column="0" Orientation="Horizontal" Margin="0,0,0,6"/>
		<!-- Items tree -->
		<TreeView x:Name="treeItems" Grid.Row="3" Grid.ColumnSpan="3" BorderThickness="1" BorderBrush="{DynamicResource ControlBorderBrush}" ItemsSource="{Binding DisplayItems}" Background="{DynamicResource PanelBackgroundBrush}" >
			<TreeView.Resources>
				<HierarchicalDataTemplate DataType="{x:Type dm:VsFolder}" ItemsSource="{Binding Items}">
					<Border Background="Transparent" Padding="2" Margin="0" SnapsToDevicePixels="True">
						<Grid>
							<Grid.ColumnDefinitions>
								<ColumnDefinition Width="Auto" />
								<ColumnDefinition Width="Auto" />
								<ColumnDefinition Width="*" />
							</Grid.ColumnDefinitions>
							<CheckBox Grid.Column="0" IsChecked="{Binding Checked, Mode=TwoWay}" VerticalAlignment="Center"/>
							<Image Grid.Column="1" Width="32" Height="32" Margin="6,0,4,0" Source="{Binding Converter={StaticResource ItemToIconConverter}}"/>
							<TextBlock Grid.Column="2" Text="{Binding Converter={StaticResource ItemToFileTextConverter}}" VerticalAlignment="Center" FontWeight="Bold" TextTrimming="CharacterEllipsis" />
						</Grid>
					</Border>
				</HierarchicalDataTemplate>
				<DataTemplate DataType="{x:Type dm:VsItem}">
					<Border Background="Transparent" Padding="2" Margin="0" SnapsToDevicePixels="True">
						<Grid>
							<Grid.ColumnDefinitions>
								<ColumnDefinition Width="Auto" />
								<ColumnDefinition Width="Auto" />
								<ColumnDefinition Width="*" />
							</Grid.ColumnDefinitions>
							<CheckBox Grid.Column="0" IsChecked="{Binding Checked, Mode=TwoWay}" VerticalAlignment="Center"/>
							<Image Grid.Column="1" Width="32" Height="32" Margin="6,0,4,0" Source="{Binding Converter={StaticResource ItemToIconConverter}}"/>
							<TextBlock Grid.Column="2" Text="{Binding Converter={StaticResource ItemToFileTextConverter}}" VerticalAlignment="Center" TextTrimming="CharacterEllipsis" />
						</Grid>
					</Border>
				</DataTemplate>
			</TreeView.Resources>
		</TreeView>
		<!-- Buttons and checkboxes -->
		<StackPanel Grid.Row="4" Grid.ColumnSpan="3" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
			<Button Width="100" Height="36" IsCancel="True" Margin="0,0,8,0">
				<DockPanel>
					<Image Source="pack://application:,,,/Resources/Images24/cancel_24x24.png" Width="24" Height="24"/>
					<TextBlock Text="Cancel" Margin="8,0,0,0" VerticalAlignment="Center" FontWeight="Bold"/>
				</DockPanel>
			</Button>
			<Button Width="100" Height="36" IsDefault="True" Click="Ok_Click" Margin="0,0,0,0">
				<DockPanel>
					<Image Source="pack://application:,,,/Resources/Images24/Check_24x24.png" Width="24" Height="24"/>
					<TextBlock Text="Import" Margin="8,0,0,0" VerticalAlignment="Center" FontWeight="Bold"/>
				</DockPanel>
			</Button>
		</StackPanel>
		<CheckBox x:Name="chkSolutionsOnly" Content="Show only Solution files" Margin="14,11,396,0" IsChecked="True" Checked="OptionChanged" Unchecked="OptionChanged" VerticalAlignment="Top" Grid.Row="4"/>
		<CheckBox x:Name="chkFlat" Content="Flat, no folder structure" Margin="217,11,166,0" Checked="OptionChanged" Unchecked="OptionChanged" VerticalAlignment="Top" Grid.Row="4"/>
	</Grid>
</Window>