<Window x:Class="VSLauncher.Views.ImportVisualStudioWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:dm="clr-namespace:VSLauncher.DataModel;assembly=VSLXshared"
        Title="Import Visual Studio Recents" Height="520" Width="700" WindowStartupLocation="CenterOwner" ResizeMode="CanResize"
        Background="{DynamicResource WindowBackgroundBrush}" Foreground="{DynamicResource WindowForegroundBrush}">
    <Grid Margin="10" Background="{DynamicResource PanelBackgroundBrush}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="Auto"/>
        </Grid.ColumnDefinitions>
        <TextBlock Grid.Row="0" Grid.Column="0" Text="MRU's found:" FontWeight="Bold" Margin="0,0,0,6"/>
        <CheckBox x:Name="chkDefaultInstances" Grid.Row="1" Grid.Column="0" Content="Show only default instance(s)" Margin="0,0,0,8" IsChecked="True" Checked="DefaultInstancesChanged" Unchecked="DefaultInstancesChanged"/>
        <Button x:Name="btnRefresh" Grid.Row="0" Grid.Column="1" Width="34" Height="26" Margin="8,0,0,6" ToolTip="Refresh" Click="Refresh_Click">
            <Image Source="pack://application:,,,/Resources/Images24/Refresh.png" Width="20" Height="20"/>
        </Button>
        <TreeView x:Name="treeRecents" Grid.Row="2" Grid.ColumnSpan="2" BorderThickness="1" BorderBrush="{DynamicResource ControlBorderBrush}" Background="{DynamicResource PanelBackgroundBrush}" ItemsSource="{Binding RootItems}">
            <TreeView.Resources>
                <HierarchicalDataTemplate DataType="{x:Type dm:VsFolder}" ItemsSource="{Binding Items}">
                    <Border Background="Transparent" Padding="2" Margin="0" SnapsToDevicePixels="True">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <CheckBox Grid.Column="0" IsChecked="{Binding Checked, Mode=TwoWay}" VerticalAlignment="Center"/>
                            <Image Grid.Column="1" Width="24" Height="24" Margin="6,0,4,0" Source="{Binding IconSource}"/>
                            <TextBlock Grid.Column="2" Text="{Binding Name}" VerticalAlignment="Center" FontWeight="Bold" TextTrimming="CharacterEllipsis" />
                        </Grid>
                    </Border>
                </HierarchicalDataTemplate>
                <DataTemplate DataType="{x:Type dm:VsItem}">
                    <Border Background="Transparent" Padding="2" Margin="0" SnapsToDevicePixels="True">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <CheckBox Grid.Column="0" IsChecked="{Binding Checked, Mode=TwoWay}" VerticalAlignment="Center"/>
                            <Image Grid.Column="1" Width="24" Height="24" Margin="6,0,4,0" Source="{Binding IconSource}"/>
                            <TextBlock Grid.Column="2" Text="{Binding Name}" VerticalAlignment="Center" TextTrimming="CharacterEllipsis" />
                        </Grid>
                    </Border>
                </DataTemplate>
            </TreeView.Resources>
        </TreeView>
        <StackPanel Grid.Row="3" Grid.ColumnSpan="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,12,0,0">
            <Button Width="100" Height="36" IsCancel="True" Margin="0,0,8,0">
                <DockPanel>
                    <Image Source="pack://application:,,,/Resources/Images24/cancel_24x24.png" Width="24" Height="24"/>
                    <TextBlock Text="Cancel" Margin="8,0,0,0" VerticalAlignment="Center" FontWeight="Bold"/>
                </DockPanel>
            </Button>
            <Button Width="100" Height="36" IsDefault="True" Click="Ok_Click">
                <DockPanel>
                    <Image Source="pack://application:,,,/Resources/Images24/Check_24x24.png" Width="24" Height="24"/>
                    <TextBlock Text="Import" Margin="8,0,0,0" VerticalAlignment="Center" FontWeight="Bold"/>
                </DockPanel>
            </Button>
        </StackPanel>
    </Grid>
</Window>